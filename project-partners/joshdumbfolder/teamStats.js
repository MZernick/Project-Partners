const data ={
    "data": {
      "users": [
        {
          "_id": "6407f0732cb481594884ed42",
          "username": "BrianKernighan",
          "personality": "INFJ",
          "compatibility": [
            {
              "type": "INFP",
              "rating": 4
            },
            {
              "type": "ENFP",
              "rating": 5
            },
            {
              "type": "INFJ",
              "rating": 4
            },
            {
              "type": "ENFJ",
              "rating": 4
            },
            {
              "type": "INTJ",
              "rating": 4
            },
            {
              "type": "ENTJ",
              "rating": 4
            },
            {
              "type": "INTP",
              "rating": 4
            },
            {
              "type": "ENTP",
              "rating": 5
            },
            {
              "type": "ISFP",
              "rating": 1
            },
            {
              "type": "ESFP",
              "rating": 1
            },
            {
              "type": "ISTP",
              "rating": 1
            },
            {
              "type": "ESTP",
              "rating": 1
            },
            {
              "type": "ISFJ",
              "rating": 1
            },
            {
              "type": "ESFJ",
              "rating": 1
            },
            {
              "type": "ISTJ",
              "rating": 1
            },
            {
              "type": "ESTJ",
              "rating": 1
            }
          ]
        },
        {
          "_id": "6407f0732cb481594884ed43",
          "username": "MaxKanat-Alexander",
          "personality": "ENTJ",
          "compatibility": [
            {
              "type": "INFP",
              "rating": 5
            },
            {
              "type": "ENFP",
              "rating": 4
            },
            {
              "type": "INFJ",
              "rating": 4
            },
            {
              "type": "ENFJ",
              "rating": 4
            },
            {
              "type": "INTJ",
              "rating": 4
            },
            {
              "type": "ENTJ",
              "rating": 4
            },
            {
              "type": "INTP",
              "rating": 5
            },
            {
              "type": "ENTP",
              "rating": 4
            },
            {
              "type": "ISFP",
              "rating": 3
            },
            {
              "type": "ESFP",
              "rating": 3
            },
            {
              "type": "ISTP",
              "rating": 3
            },
            {
              "type": "ESTP",
              "rating": 3
            },
            {
              "type": "ISFJ",
              "rating": 3
            },
            {
              "type": "ESFJ",
              "rating": 3
            },
            {
              "type": "ISTJ",
              "rating": 3
            },
            {
              "type": "ESTJ",
              "rating": 3
            }
          ]
        },
        // {
        //   "_id": "6407f0732cb481594884ed44",
        //   "username": "Amiko",
        //   "personality": "INFP",
        //   "compatibility": []
        // },
        {
          "_id": "6407f0732cb481594884ed45",
          "username": "KentBeck",
          "personality": "ESFP",
          "compatibility": [
            {
              "type": "INFP",
              "rating": 1
            },
            {
              "type": "ENFP",
              "rating": 1
            },
            {
              "type": "INFJ",
              "rating": 1
            },
            {
              "type": "ENFJ",
              "rating": 5
            },
            {
              "type": "INTJ",
              "rating": 3
            },
            {
              "type": "ENTJ",
              "rating": 3
            },
            {
              "type": "INTP",
              "rating": 3
            },
            {
              "type": "ENTP",
              "rating": 3
            },
            {
              "type": "ISFP",
              "rating": 2
            },
            {
              "type": "ESFP",
              "rating": 2
            },
            {
              "type": "ISTP",
              "rating": 2
            },
            {
              "type": "ESTP",
              "rating": 2
            },
            {
              "type": "ISFJ",
              "rating": 3
            },
            {
              "type": "ESFJ",
              "rating": 5
            },
            {
              "type": "ISTJ",
              "rating": 3
            },
            {
              "type": "ESTJ",
              "rating": 5
            }
          ]
        },
        {
          "_id": "6407f0732cb481594884ed46",
          "username": "EdwardV.Berard",
          "personality": "ESTP",
          "compatibility": [
            {
              "type": "INFP",
              "rating": 1
            },
            {
              "type": "ENFP",
              "rating": 1
            },
            {
              "type": "INFJ",
              "rating": 1
            },
            {
              "type": "ENFJ",
              "rating": 1
            },
            {
              "type": "INTJ",
              "rating": 3
            },
            {
              "type": "ENTJ",
              "rating": 3
            },
            {
              "type": "INTP",
              "rating": 3
            },
            {
              "type": "ENTP",
              "rating": 3
            },
            {
              "type": "ISFP",
              "rating": 2
            },
            {
              "type": "ESFP",
              "rating": 2
            },
            {
              "type": "ISTP",
              "rating": 2
            },
            {
              "type": "ESTP",
              "rating": 2
            },
            {
              "type": "ISFJ",
              "rating": 5
            },
            {
              "type": "ESFJ",
              "rating": 3
            },
            {
              "type": "ISTJ",
              "rating": 5
            },
            {
              "type": "ESTJ",
              "rating": 3
            }
          ]
        },
        {
          "_id": "6407f0732cb481594884ed47",
          "username": "AlanKay",
          "personality": "ENFJ",
          "compatibility": [
            {
              "type": "INFP",
              "rating": 5
            },
            {
              "type": "ENFP",
              "rating": 4
            },
            {
              "type": "INFJ",
              "rating": 4
            },
            {
              "type": "ENFJ",
              "rating": 4
            },
            {
              "type": "INTJ",
              "rating": 4
            },
            {
              "type": "ENTJ",
              "rating": 4
            },
            {
              "type": "INTP",
              "rating": 4
            },
            {
              "type": "ENTP",
              "rating": 4
            },
            {
              "type": "ISFP",
              "rating": 5
            },
            {
              "type": "ESFP",
              "rating": 1
            },
            {
              "type": "ISTP",
              "rating": 1
            },
            {
              "type": "ESTP",
              "rating": 1
            },
            {
              "type": "ISFJ",
              "rating": 1
            },
            {
              "type": "ESFJ",
              "rating": 1
            },
            {
              "type": "ISTJ",
              "rating": 1
            },
            {
              "type": "ESTJ",
              "rating": 1
            }
          ]
        },
        {
          "_id": "6407f0732cb481594884ed48",
          "username": "C.A.R.Hoare",
          "personality": "ISTJ",
          "compatibility": [
            {
              "type": "INFP",
              "rating": 1
            },
            {
              "type": "ENFP",
              "rating": 1
            },
            {
              "type": "INFJ",
              "rating": 1
            },
            {
              "type": "ENFJ",
              "rating": 1
            },
            {
              "type": "INTJ",
              "rating": 2
            },
            {
              "type": "ENTJ",
              "rating": 3
            },
            {
              "type": "INTP",
              "rating": 2
            },
            {
              "type": "ENTP",
              "rating": 2
            },
            {
              "type": "ISFP",
              "rating": 3
            },
            {
              "type": "ESFP",
              "rating": 5
            },
            {
              "type": "ISTP",
              "rating": 3
            },
            {
              "type": "ESTP",
              "rating": 5
            },
            {
              "type": "ISFJ",
              "rating": 4
            },
            {
              "type": "ESFJ",
              "rating": 4
            },
            {
              "type": "ISTJ",
              "rating": 4
            },
            {
              "type": "ESTJ",
              "rating": 4
            }
          ]
        },
        {
          "_id": "6407f0732cb481594884ed49",
          "username": "DavidThomas",
          "personality": "ESTJ",
          "compatibility": [
            {
              "type": "INFP",
              "rating": 1
            },
            {
              "type": "ENFP",
              "rating": 1
            },
            {
              "type": "INFJ",
              "rating": 1
            },
            {
              "type": "ENFJ",
              "rating": 1
            },
            {
              "type": "INTJ",
              "rating": 2
            },
            {
              "type": "ENTJ",
              "rating": 3
            },
            {
              "type": "INTP",
              "rating": 5
            },
            {
              "type": "ENTP",
              "rating": 2
            },
            {
              "type": "ISFP",
              "rating": 5
            },
            {
              "type": "ESFP",
              "rating": 3
            },
            {
              "type": "ISTP",
              "rating": 5
            },
            {
              "type": "ESTP",
              "rating": 3
            },
            {
              "type": "ISFJ",
              "rating": 4
            },
            {
              "type": "ESFJ",
              "rating": 4
            },
            {
              "type": "ISTJ",
              "rating": 4
            },
            {
              "type": "ESTJ",
              "rating": 4
            }
          ]
        },
        {
          "_id": "6407f0732cb481594884ed4a",
          "username": "DonaldKnuth",
          "personality": "ENFJ",
          "compatibility": [
            {
              "type": "INFP",
              "rating": 5
            },
            {
              "type": "ENFP",
              "rating": 4
            },
            {
              "type": "INFJ",
              "rating": 4
            },
            {
              "type": "ENFJ",
              "rating": 4
            },
            {
              "type": "INTJ",
              "rating": 4
            },
            {
              "type": "ENTJ",
              "rating": 4
            },
            {
              "type": "INTP",
              "rating": 4
            },
            {
              "type": "ENTP",
              "rating": 4
            },
            {
              "type": "ISFP",
              "rating": 5
            },
            {
              "type": "ESFP",
              "rating": 1
            },
            {
              "type": "ISTP",
              "rating": 1
            },
            {
              "type": "ESTP",
              "rating": 1
            },
            {
              "type": "ISFJ",
              "rating": 1
            },
            {
              "type": "ESFJ",
              "rating": 1
            },
            {
              "type": "ISTJ",
              "rating": 1
            },
            {
              "type": "ESTJ",
              "rating": 1
            }
          ]
        },
        {
          "_id": "6407f0732cb481594884ed4b",
          "username": "Lernantino",
          "personality": "ISTP",
          "compatibility": [
            {
              "type": "INFP",
              "rating": 1
            },
            {
              "type": "ENFP",
              "rating": 1
            },
            {
              "type": "INFJ",
              "rating": 1
            },
            {
              "type": "ENFJ",
              "rating": 1
            },
            {
              "type": "INTJ",
              "rating": 3
            },
            {
              "type": "ENTJ",
              "rating": 3
            },
            {
              "type": "INTP",
              "rating": 3
            },
            {
              "type": "ENTP",
              "rating": 3
            },
            {
              "type": "ISFP",
              "rating": 2
            },
            {
              "type": "ESFP",
              "rating": 2
            },
            {
              "type": "ISTP",
              "rating": 2
            },
            {
              "type": "ESTP",
              "rating": 2
            },
            {
              "type": "ISFJ",
              "rating": 3
            },
            {
              "type": "ESFJ",
              "rating": 5
            },
            {
              "type": "ISTJ",
              "rating": 3
            },
            {
              "type": "ESTJ",
              "rating": 5
            }
          ]
        }
      ]
    }
  }



//return the compatibility between two users
function getCompatibility(user1, user2) {
    let comp = user1.compatibility;
    // console.log(user1.username + " scores:");
    // console.log(comp);
    // console.log(user2.username + " personality type: " +user2.personality);
    const result = comp.find(({type}) => type === user2.personality);
    // console.log(result);
    return result.rating;
}

// console.log(getCompatibility(data.data.users[0], data.data.users[1]));
//Thanks Dom for making this!
function getCompatibilityandUsername(user1, user2) {
  let comp = user1.compatibility;
  const result = comp.find(({type}) => type === user2.personality);
     return {value:`${user2._id}`, username: `${user2.username}`, rating: `${result.rating}`};
};


//TO DO: write function that returns array of compatibility rating between each of the users and the first user in the array
function indivTeamScores(teamArray, user1) {
    // console.log("original array of users length: " + teamArray.length)
    // let comp = user1.compatibility;
    // console.log(user1.username + " scores:");
    // console.log(comp);
    let tempTeamArray = [];
    tempTeamArray.push(...teamArray);
    // console.log("tempTeamArray BEFORE removing user1:")
    // tempTeamArray.forEach(member => {
    //     console.log(member.username + " personality: " + member.personality)
    // });

    const user1index = tempTeamArray.findIndex(({_id}) => _id === user1._id);
    tempTeamArray.splice(user1index, 1);
    // console.log("tempTeamArray AFTER removing user1:")
    // tempTeamArray.forEach(member => {
    //     console.log(member.username + " personality: " + member.personality)
    // });

    let scores = [];
    tempTeamArray.forEach(member => {
            scores.push(getCompatibility(user1, member));
            
    });
    // console.log(scores);
    // console.log("scores length: " +scores.length);
    // console.log("teamArray length: " +teamArray.length);
    // const avgTeamScore = scores.reduce((a, b) => a + b)/scores.length;
    // console.log("avgTeamScore: " +avgTeamScore);

    return scores
};


const allTheUsers = data.data.users;
// console.log(allTheUsers)
// console.log("individual team scores: " + indivTeamScores(allTheUsers, allTheUsers[0]));
// console.log("original array of users length: " + allTheUsers.length)

//check if this works for an array of users
const scores1 = indivTeamScores(allTheUsers, allTheUsers[0]);

console.log("scores1 values: " + scores1);
//write a basic reusable average function for an array of numbers
function avg(numArray) {
    let sum = 0;
    for (let i = 0; i < numArray.length; i++) {
        sum += numArray[i];
    }
    return sum/numArray.length;
}

console.log(avg(scores1));

function myTeamScore(teamArray, User1) {
    let arrayToAverage = indivTeamScores(teamArray, User1);
    return avg(arrayToAverage);
}

function oneBigTeamScore(teamArray) {
    const bigScores = [];
    for (let i = 0; i < teamArray.length; i++) {
        // console.log("running indiv team scores for user: " + teamArray[i].username);
        let lilScores = indivTeamScores(teamArray, teamArray[i]);
        // console.log(lilScores);
        bigScores.push(...lilScores)
    }
    // console.log(bigScores);
    // console.log("bigScores length: " + bigScores.length);
    return avg(bigScores);
}

console.log("myTeamScore: " +myTeamScore(allTheUsers, allTheUsers[0]));

console.log("the big 'ol team score is: " + oneBigTeamScore(allTheUsers));

//JOSH START HERE need to do more console.log invistgating to figure this out, but should work to build sub-lists

function makeObjectListofOthers(teamArray, user1) {
  
  let tempTeamArray = [];
  tempTeamArray.push(...teamArray);
  const user1index = tempTeamArray.findIndex(({_id}) => _id === user1._id);
  tempTeamArray.splice(user1index, 1);
  // console.log("tempTeamArray AFTER removing user1:")

  let nameAndscores = [];
  tempTeamArray.forEach(member => {
          nameAndscores.push(getCompatibilityandUsername(user1, member));
          
  });
  // console.log(nameAndscores);

  return nameAndscores
};

console.log(makeObjectListofOthers(allTheUsers, allTheUsers[0]));